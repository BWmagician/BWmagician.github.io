<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8">
    <link rel="icon" href="/img/icon.ico">
    <title>
        网络流杂谈
    </title>
    <!-- 引入firacode字体，给代码块用的 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/firacode@6.2.0/distr/fira_code.css">
    
<link rel="stylesheet" href="/css/main.css">

    
<link rel="stylesheet" href="/css/index.css">

    
<link rel="stylesheet" href="/css/post.css">

    
<link rel="stylesheet" href="/css/category.css">

    
<link rel="stylesheet" href="/css/aside.css">

    
<link rel="stylesheet" href="/css/archive.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
    <!-- 生成导航栏 -->
    <nav id="navigation">
        <div id="navBoxsLeft">
            <span class="navBox" id="navHome">
                <a href="/" class="navText">
                    首页
                </a>
            </span>
            <span class="navBox">
                <img id="lightDarkButton" onclick="changeModel()"> 
            </span>
        </div>
        <div id="navBoxsRight">
            
                
            
                
                    <div class="navBox">
                        <a href="/categories" class="navText">
                            分类
                        </a>
                    </div>
                
            
                
                    <div class="navBox">
                        <a href="/archives" class="navText">
                            归档
                        </a>
                    </div>
                
            
                
                    <div class="navBox">
                        <a href="/about" class="navText">
                            关于
                        </a>
                    </div>
                
             
        <div>
    </nav>
    <main>
        <!-- 插入主体内容 -->
        <container id="container" >
            <postContent id="postContent">
    <postHeader>
        <h1 style="margin-bottom: 10px;" class="postTitle"> 网络流杂谈 </h1>
        
        <!-- 生成副标题，就是显示作者分类那一行 -->
        <div id="postSubtitle">
            作者 : BWmagician | 分类 :  
            
                
                    <a href="/categories/?category=某些算法">
                        
                            某些算法
                        
                    </a>
                
                    <a href="/categories/?category=涂论">
                        
                            &gt; 涂论
                        
                    </a>
                
            
        </div>
    </postHeader>
    <h3 id="某图的最小割的可行割边不会是-任意-残量图中未满流的边">某图的最小割的可行割边不会是(任意)残量图中未满流的边</h3>
<p>做<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4126">这题</a>的时候看到讨论区有人问为什么残量网络中未满流的边不会是可行边。感性上看，如果未满流则说明受制于某边，那么割那一条边是严格更优的，因此不会有最小割方案包含一条残量图中未满流的边。<br>
但这样还是太玄乎了，我们尝试用符号证明。假设对于图$G(E,V)$有一组最小割$C=\{e_1,e_2,…\}$，选其中一条流为$f$的边$e$，图$G(E,V)$的最大流是$M$。我们考察$G(E \backslash \{e\},V)$，对于这个图，$C \backslash \{e\}$是一组可行的割；$M-f$是可行的流。则发现割等于流，那么对于$G(E\backslash \{e\},V)$ ，$C \backslash \{e\}$是一组可行的最小割同时$M-f$是最大流。<br>
因此，如果某条边是可行的割边，割去他之后剩下的图的最大流应该保持$M-f$。考虑残量图未满流的边，我们说他还剩余$k$的流量，如果去掉这条边，则剩余图的一个可行流是$M-f+k$，则剩余图的最大流已经超过了$M-f$，因此残量图未流满的边是不会成为可行边的。</p>
<h3 id="对-任意-残量图缩点后处于一个SCC内的边不可能为可行边，并且DAG中的满流边必定为可行割边">对(任意)残量图缩点后处于一个SCC内的边不可能为可行边，并且DAG中的满流边必定为可行割边</h3>
<p>如果顺着这个SCC里的某个圈流一个流，则某边变为残量图中未流满的边，那么根据上一个结论，不可能为可行边。</p>
<p>如果我们砍掉任意DAG上的流为$f$的满流边$e$，则对于$G(E \backslash \{e\},V)$流至少减少$f$，因为不可能找到另外路径使这$f$流中的任意一一单位的流到$t$，不然构成SCC。那么根据上一个结论，为可行边。</p>
<h3 id="闭合子图与割">闭合子图与割</h3>
<p>闭合子图就是在一个有向图里选出一些点集，使其中每个点的后继不在子图外（注意到这些闭合子图随意并起来都会是一个闭合子图，后文的最大权闭合子图也可能是这样并起来的形式，因此我们说找到<strong>一个</strong>闭合子图即可）。闭合子图的后继对应了实际题目中的一些“先后”的逻辑关系，譬如说取一个格子之后四周的格子不能取，则一旦“取”就必然导致四个“不能取”的后果。譬如为了得到一些利润，要先付钱做一些事，则“做事”先于“赚取利润”，一旦“赚取利润”则推导出“我做过这件事”，这也是一种先后的逻辑关系与后继的对应。</p>
<p>那么，实际题目的一个合理情况则对应了一个闭合子图。其中，所有的“先后顺序”都被满足对应了闭合子图没有点的后继在子图外。比如<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4174">P4174</a>，“付费建站”先于“赚取利润”，因此我们可以这样建图：把“利润”，“付费建站”看作点，点权设为赚钱或付钱的数目 ，每个“利润”的后继设为对应的“付费建站”（即连多条有向边到对应的站）。意味一旦收取这部分利润则必须建某某站。注意到这张图的点权是有正有负的，由于题目允许选取空集（即一点钱都不赚），这道题的利润最大化等效于找出一个闭合子图，使他的权值最大。这样的闭合子图称为最大权闭合子图。</p>
<p>处理正负则需要联系到割，我们可以做这样的构造：将点值为负的点连到汇点，边权为点值的绝对值；从源点连到正点值的点，边权为点值。这样做的正确性在于：割去连到汇点的边代表选择负点值的点，割去从源点连出的边代表不选择这个正点值的点，由于我们不可以选择一个点而不选择后继，每个从源点到汇点的通路代表一个需要被考虑的后继关系（可以想象，仅是正到负的情况应该被考虑，如果选择一个点之后发现它的后继是正的，则无脑连接，如果从一个负点出发找后继则不如不选这个负点），则必须割其中一个边代表是否选择拥有这一对后继关系。那么这张图的任意闭合子图的权值和即所有选择的点的点值之和，即正点值之和减去割。其中要最大化闭合子图的权值和，需要求最小割。</p>
<p>需要注意的是，源汇点不可以随意调换，因为在“先后”关系中，我们总是先有负贡献，再有正贡献，因此总是正点值的后继为负点值，这已经为我们提供了源点到汇点的流向。</p>
<h3 id="费用流跑二分图的建图优化">费用流跑二分图的建图优化</h3>
<p>做<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5331">这题</a>的时候虽然没想到用cdq的思路构图，<s>但打暴力草过去了</s>，但注意到建图优化其实比较常见，手法也比较多样。<br>
<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P6061">这</a>是一道非常经典的建图优化题。题意是给你一个有边权的有向图，你可以每次选择一个环，环的费用是在图中绕这个环走一圈的距离和，求选择多个环保证每个点都被覆盖的最小费用（特殊的，选一个点当环也给了费用）。实际做法和<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2764">经典题目</a>差不多。那么先拆点，然后每个左侧点$i$到每个右侧点$j$的最短路作为费用从$i$到$j$连边，流为1，如果选择此边，则表示选环方案中包含了$i \to j$；对于单个点成环的情况，横向连边；源点连向左侧点，右侧点连向汇点流都为1，费用都为0。这样做的正确性在于，二分图简化了点在环中的存在，实际选环的时候某个点可能会重复出现在一些环中，但在这个二分图中一个点会并只会连出一条边(左侧点的意义)，会并只会被一条边连接(右侧点的意义)，那么这个二分图会且只会分割成数个环。但是这样做边数是$O(n^2)$的。我们可以这样连接，连所有从右到左的横向边流为无限，费用为0，连边方案不选择最短路，而是直接按照原图的边进行连接。例如某边$(u,v,dis)$，连$(u_{left},v_{right},dis)$这条边。这样优化连边之后边数降到了$O(n)$，并且是可以通过费用流算法里的spfa计算最短路的，具体来说，一条最短路可以通过 “左侧点$\to$右侧点”,“右侧点顺着0费边流到左侧点二号”,“左侧点二号$\to$右侧点二号”…这样表示出来。</p>
<p>你可能会说这样连边岂不是构造出了好多非最短路。对的，但是我们绝对不会去跑非最短路，费用流会自动跑最优的那些，这是费用流算法本身决定的。这类题目的核心思想就是，通过一些手法合理的减少边数，使费用流在实际工作时总是选择正确的路径。</p>
<h3 id="最小路径覆盖如果不是在DAG上会怎么样">最小路径覆盖如果不是在DAG上会怎么样</h3>
<p>其实就像上一个讨论中提到的那样，会变成数个环。因此，很多需要拆点打二分图的题目要给出额外限制，让原图保持无环，即二分图不可以出现连出环的方案。</p>

</postContent>

<aside>
    <div>
    
        
        
            
                <a href="#某图的最小割的可行割边不会是-任意-残量图中未满流的边">
                    <div class="asiderH3" style="display: none">
                        某图的最小割的可行割边不会是(任意)残量图中未满流的边
                    </div>
                </a>
            
        
            
                <a href="#对-任意-残量图缩点后处于一个SCC内的边不可能为可行边，并且DAG中的满流边必定为可行割边">
                    <div class="asiderH3" style="display: none">
                        对(任意)残量图缩点后处于一个SCC内的边不可能为可行边，并且DAG中的满流边必定为可行割边
                    </div>
                </a>
            
        
            
                <a href="#闭合子图与割">
                    <div class="asiderH3" style="display: none">
                        闭合子图与割
                    </div>
                </a>
            
        
            
                <a href="#费用流跑二分图的建图优化">
                    <div class="asiderH3" style="display: none">
                        费用流跑二分图的建图优化
                    </div>
                </a>
            
        
            
                <a href="#最小路径覆盖如果不是在DAG上会怎么样">
                    <div class="asiderH3" style="display: none">
                        最小路径覆盖如果不是在DAG上会怎么样
                    </div>
                </a>
            
        
        <!-- 补齐最后一个 -->
        </details>
    
</div>
</aside>
        </container>
        <!-- 生成页脚 -->
        <!-- 防止footer闪现 -->
        <footer id="footer" style="visibility:hidden">
            
                <p> ©2025 - 2025 by BWmagician </p>
                <p> 框架: <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/"> hexo</a> |
                    主题: <a target="_blank" rel="noopener" href="https://bwmagician.github.io/2025/06/24/%E5%85%B3%E4%BA%8Ebw%E4%B8%BB%E9%A2%98/">bw</a> </p>
            
            <div> 若要转载，请先联系作者 </div>
            <div>  </div>
        </footer>
    </main>
    
<script src="/js/main.js"></script>

    <!-- 插入mathjax的cdn，具体配置可以参照https://www.cnblogs.com/wangxin37/p/8185688.html这篇文章 -->
    <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": { 
        preferredFont: "TeX", 
        availableFonts: ["STIX","TeX"], 
        linebreaks: { automatic:true }, 
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: { 
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ], 
        processEscapes: true, 
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {  
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, 
        Macros: { href: "{}" } 
    },
    messageStyle: "none",
    }); 
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script>
MathJax = {
  loader: {load: ['[tex]/ams']},
  tex: {
    inlineMath: [['$', '$']],
    packages: {'[+]': ['ams']}
  },
  // 关键设置：全局缩放比例（1.2表示放大20%）
  chtml: {
    scale: 2
  },
  // 或 SVG 渲染器
  svg: {
    scale: 2
  }
};
</script>
    <!-- 引入必要的js代码 -->
    
    
        
<script src="/js/aside.js"></script>

        
            
<script src="/js/post.js"></script>

        
    
    
</body>

</html>